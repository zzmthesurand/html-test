<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Macronutrient Breakdown</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>Macronutrient Breakdown</h1>
    <p>Enter the number of kcal or kJ and we'll calculate the grams of protein, carbs, and fat:</p>

    <label for="energy">Energy (kcal or kJ):</label>
    <input type="number" id="energy" placeholder="Enter kcal or kJ" />
    <select id="energyType">
        <option value="kcal">kcal</option>
        <option value="kj">kJ</option>
    </select>
    <button onclick="calculate()">Calculate</button>

    <h2>Results:</h2>
    <div>
        <p>Protein (g): <span id="protein"></span></p>
        <p>Carbs (g): <span id="carbs"></span></p>
        <p>Fat (g): <span id="fat"></span></p>
    </div>

    <canvas id="macronutrientChart"></canvas>

    <script>
        function calculate() {
            let energy = parseFloat(document.getElementById("energy").value);
            const energyType = document.getElementById("energyType").value;

            // Convert kJ to kcal if necessary
            if (energyType === "kj") {
                energy = energy / 4.184; // Convert kJ to kcal
            }

            // Assume an example ratio of macronutrients
            const fat_g = energy * 0.3 / 9; // 30% from fat
            const protein_g = energy * 0.25 / 4; // 25% from protein
            const carbs_g = energy * 0.45 / 4; // 45% from carbs

            // Update the result in the DOM
            document.getElementById("protein").textContent = protein_g.toFixed(2);
            document.getElementById("carbs").textContent = carbs_g.toFixed(2);
            document.getElementById("fat").textContent = fat_g.toFixed(2);

            // Create the chart
            const ctx = document.getElementById("macronutrientChart").getContext("2d");
            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Protein (g)', 'Carbs (g)', 'Fat (g)'],
                    datasets: [{
                        label: 'Macronutrient Breakdown',
                        data: [protein_g, carbs_g, fat_g],
                        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56'],
                        hoverOffset: 4
                    }]
                }
            });
        }
    </script>
</body>
</html>
